import{c as e,u as s,r as a,j as t,B as r}from"./index-DuP29WnI.js";import{i as l}from"./axiosClient-BhEPqxcn.js";import{u as n}from"./useMutation-DEcMuSr-.js";import{u as o,a as i,L as d,t as m,o as c,s as u}from"./index-CQHPdDus.js";import{I as x}from"./input-Cj5H0HvW.js";import{C as h,a as p,d as w,e as g,b as f}from"./card-UT-ZE_p0.js";function j(e={}){const{mutation:s={},client:a={}}=e??{},{client:t,...r}=s,o=r.mutationKey??[{url:"/api/auth/set-password"}];return n({mutationFn:async({data:e})=>async function(e,s={}){const{client:a=l,...t}=s;return await a({method:"POST",url:"/api/auth/set-password",data:e,...t,headers:{"Content-Type":"application/*+json",...t.headers}})}(e,a),mutationKey:o,...r},t)}const b=c({password:u().min(8,"Password harus minimal 8 karakter").refine(e=>{const s=/[A-Z]/.test(e),a=/[a-z]/.test(e),t=/\d/.test(e),r=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e);return s&&a&&t&&r},{message:"Harus mengandung huruf besar, huruf kecil, angka, dan simbol"}),confirmPassword:u()}).refine(e=>e.password===e.confirmPassword,{message:"Password tidak cocok",path:["confirmPassword"]}),v=e("/ForgotPassword/SetNewPassword/")({component:function(){const e=s(),[l,n]=a.useState(""),[c,u]=a.useState(!1),[v,N]=a.useState(!1),y=(e=>{if(!e)return{score:0,label:"",width:"0%"};let s=0;e.length>=8&&(s+=1),e.length>=12&&(s+=1),/[A-Z]/.test(e)&&(s+=1),/[a-z]/.test(e)&&(s+=1),/\d/.test(e)&&(s+=1),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(e)&&(s+=1),/(.)\1\1/.test(e)&&(s-=1);let a="",t="0%",r="";return s<3?(a="Lemah",t="33%",r="bg-red-500"):s<5?(a="Sedang",t="66%",r="bg-yellow-500"):(a="Kuat",t="100%",r="bg-green-500"),{score:s,label:a,width:t,color:r}})(l),k=o({resolver:i(b),defaultValues:{password:"",confirmPassword:""}}),P=localStorage.getItem("resetPasswordEmail")||"",{mutate:M,isPending:z,isSuccess:S}=j({mutation:{onSuccess:s=>{m.success("Password Diperbarui!",{description:s.message||"Password Anda berhasil diperbarui. Silakan login dengan password baru Anda."}),localStorage.removeItem("resetPasswordEmail"),setTimeout(()=>{e({to:"/Login"})},1500)},onError:e=>{m.error("Gagal Memperbarui Password",{description:e.message||"Terjadi kesalahan saat memperbarui password."})}}});return t.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 sm:p-6",children:t.jsxs(h,{className:"w-full max-w-md shadow-xl rounded-2xl border-0 bg-white/90 backdrop-blur-sm",children:[t.jsxs(p,{className:"text-center px-6 pt-8 pb-4",children:[t.jsx("div",{className:"mx-auto bg-blue-100 p-3 rounded-full w-16 h-16 flex items-center justify-center mb-4",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-blue-600",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),t.jsx(w,{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:"Atur Password Baru"}),t.jsxs(g,{className:"mt-2 text-gray-600 text-sm sm:text-base",children:["Buat password baru untuk akun ",t.jsx("span",{className:"font-semibold text-blue-600 break-all",children:P||"Anda"})]})]}),t.jsxs(f,{className:"px-6 pb-8",children:[t.jsxs("form",{onSubmit:k.handleSubmit(e=>{M({data:{email:P,password:e.password}})}),className:"space-y-6",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password Baru"}),t.jsxs("div",{className:"relative",children:[t.jsx(x,{...k.register("password"),id:"password",type:c?"text":"password",placeholder:"Masukkan password baru",className:"py-5 pr-10",onChange:e=>{k.setValue("password",e.target.value),n(e.target.value)}}),t.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700",onClick:()=>u(!c),children:c?t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[t.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),t.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[t.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),t.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),t.jsxs("div",{className:"mt-2",children:[t.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full rounded-full transition-all duration-300 ${y.color}`,style:{width:y.width}})}),t.jsxs("div",{className:"flex justify-between mt-1",children:[t.jsx("span",{className:"text-xs font-medium "+(y.score<3?"text-red-500":y.score<5?"text-yellow-500":"text-green-500"),children:y.label}),t.jsxs("span",{className:"text-xs text-gray-500",children:[l.length,"/12"]})]})]}),k.formState.errors.password&&t.jsx("p",{className:"mt-1 text-sm text-red-500",children:k.formState.errors.password.message})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Konfirmasi Password"}),t.jsxs("div",{className:"relative",children:[t.jsx(x,{...k.register("confirmPassword"),id:"confirmPassword",type:v?"text":"password",placeholder:"Konfirmasi password baru",className:"py-5 pr-10"}),t.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700",onClick:()=>N(!v),children:v?t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[t.jsx("path",{d:"M10 12a2 2 0 100-4 2 2 0 000 4z"}),t.jsx("path",{fillRule:"evenodd",d:"M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z",clipRule:"evenodd"})]}):t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[t.jsx("path",{fillRule:"evenodd",d:"M3.707 2.293a1 1 0 00-1.414 1.414l14 14a1 1 0 001.414-1.414l-1.473-1.473A10.014 10.014 0 0019.542 10C18.268 5.943 14.478 3 10 3a9.958 9.958 0 00-4.512 1.074l-1.78-1.781zm4.261 4.26l1.514 1.515a2.003 2.003 0 012.45 2.45l1.514 1.514a4 4 0 00-5.478-5.478z",clipRule:"evenodd"}),t.jsx("path",{d:"M12.454 16.697L9.75 13.992a4 4 0 01-3.742-3.741L2.335 6.578A9.98 9.98 0 00.458 10c1.274 4.057 5.065 7 9.542 7 .847 0 1.669-.105 2.454-.303z"})]})})]}),k.formState.errors.confirmPassword&&t.jsx("p",{className:"mt-1 text-sm text-red-500",children:k.formState.errors.confirmPassword.message})]}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("p",{className:"text-sm font-medium text-blue-800 mb-2",children:"Persyaratan Password:"}),t.jsxs("ul",{className:"text-sm text-blue-700 space-y-1 list-disc pl-5",children:[t.jsx("li",{className:l.length>=8?"text-green-600":"",children:"Minimal 8 karakter"}),t.jsx("li",{className:/[A-Z]/.test(l)?"text-green-600":"",children:"Mengandung huruf besar (A-Z)"}),t.jsx("li",{className:/[a-z]/.test(l)?"text-green-600":"",children:"Mengandung huruf kecil (a-z)"}),t.jsx("li",{className:/\d/.test(l)?"text-green-600":"",children:"Mengandung angka (0-9)"}),t.jsx("li",{className:/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(l)?"text-green-600":"",children:"Mengandung simbol (!@#$%^&*, dll)"})]})]})]}),t.jsx(r,{type:"submit",disabled:z||S,className:"w-full py-6 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-medium rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl",children:z?t.jsxs(t.Fragment,{children:[t.jsx(d,{className:"mr-2 h-5 w-5 animate-spin"}),"Memperbarui..."]}):S?"Password Diperbarui!":"Atur Password Baru"})]}),S&&t.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-xl text-green-700 text-center animate-fade-in",children:[t.jsxs("p",{className:"font-medium flex items-center justify-center gap-2",children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:t.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Password berhasil diperbarui!"]}),t.jsx("p",{className:"text-sm mt-1",children:"Mengarahkan ke halaman login..."})]})]})]})})}});export{v as Route};
